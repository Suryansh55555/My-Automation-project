{% extends "base.html" %}
{% block content %}
<h2>ðŸ“Š Dashboard</h2>
<div class="row mb-4">
  <div class="col-md-4">
    <div class="card p-3">
      <h5>Total Revenue</h5>
      <p class="fs-4 text-success">â‚¹{{ "%.2f"|format(total_revenue) }}</p>
    </div>
  </div>
  <div class="col-md-4">
    <div class="card p-3">
      <h5>Total Orders</h5>
      <p class="fs-4">{{ total_orders }}</p>
    </div>
  </div>
  <div class="col-md-4">
    <div class="card p-3">
      <h5>Last Payment</h5>
      <p class="fs-6">{{ last_payment_id }} (â‚¹{{ "%.2f"|format(last_payment_amount) }})</p>
    </div>
  </div>
</div>

<div class="d-flex justify-content-between align-items-center mb-2">
  <h4>Recent Payments</h4>
  <form method="POST" action="{{ url_for('clear_history') }}" onsubmit="return confirm('Are you sure you want to clear all payment history?');">
    <button class="btn btn-sm btn-danger">Clear History</button>
  </form>
</div>

<table class="table table-striped table-hover">
  <thead class="table-dark">
    <tr>
      <th>Payment ID</th>
      <th>Order ID</th>
      <th>Amount (â‚¹)</th>
      <th>Status</th>
    </tr>
  </thead>
  <tbody>
    {% for p in payments %}
    <tr>
      <td>{{ p.payment_id }}</td>
      <td>{{ p.order_id or "N/A" }}</td>
      <td>â‚¹{{ "%.2f"|format(p.amount) }}</td>
      <td>
        {% if p.status == "VERIFIED" %}
          <span class="badge bg-success badge-status">Success</span>
        {% elif p.status == "UNVERIFIED" %}
          <span class="badge bg-warning text-dark badge-status">Pending</span>
        {% else %}
          <span class="badge bg-danger badge-status">{{ p.status }}</span>
        {% endif %}
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>
{% endblock %}
